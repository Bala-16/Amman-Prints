{%extends "nav.html"%}
{%block title%}Measurement Creation{%endblock%}
{%block extra_head%}
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>

<style>
  .modal { display:none }
  .modal.active { display:flex }
</style>
{%endblock%}
{%block content%}

<div class="min-h-screen bg-slate-50 p-4">

<div class="max-w-7xl mx-auto space-y-6">

<!-- HEADER -->
<!-- <div class="bg-gradient-to-r from-teal-600 to-cyan-600 rounded-xl p-6 flex justify-between items-center">
  <h1 class="text-white text-xl font-bold">Measurement Creation</h1>
  <button onclick="openModal()" class="bg-white text-teal-600 px-4 py-2 rounded-lg font-semibold">
    + New Measurement
  </button>
</div> -->
<!-- HEADER -->
<div class="bg-gradient-to-r from-teal-600 to-cyan-600 rounded-xl p-6">
  <div class="flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center">

    <h1 class="text-white text-xl font-bold">Measurement Creation</h1>

    <button onclick="openModal()"
      class="bg-white text-teal-600 px-4 py-2 rounded-lg font-semibold w-fit">
      + New Measurement
    </button>

  </div>
</div>


<!-- DESKTOP TABLE -->
<div class="hidden md:block bg-white rounded-xl shadow overflow-x-auto">
<table class="w-full">
<thead class="bg-slate-100">
<tr>
  <th class="p-3">#</th>
  <th class="p-3 text-left">Measurement</th>
  <th class="p-3 text-left">Remarks</th>
  <th class="p-3 text-center">Edit</th>
  <th class="p-3 text-center">Delete</th>
</tr>
</thead>
<tbody id="measurementTable"></tbody>
</table>
</div>

<!-- MOBILE CARDS -->
<div id="measurementCards" class="grid gap-4 md:hidden"></div>

</div>

<!-- MODAL -->
<div id="modal" class="modal fixed inset-0 bg-black/40 items-center justify-center z-50">
<div class="bg-white rounded-xl w-full max-w-md p-6">
<h2 class="text-lg font-bold mb-4">Measurement</h2>

<input id="nameInput" placeholder="Measurement name" class="w-full border p-2 rounded mb-3">
<textarea id="remarksInput" placeholder="Remarks" class="w-full border p-2 rounded mb-4"></textarea>

<div class="flex justify-end gap-3">
<button onclick="closeModal()" class="px-4 py-2 border rounded">Cancel</button>
<button onclick="saveMeasurement()" class="px-6 py-2 bg-teal-600 text-white rounded">Save</button>
</div>
</div>
</div>
</div>
{%endblock%}
{%block extra_js%}
<script>
let measurements = [
 {name:"Centimeter (cm)",remarks:"Metric unit"},
 {name:"Inch (in)",remarks:"Imperial unit"},
 {name:"Meter (m)",remarks:"Large measurements"}
]

let editIndex = null

function renderUI(){
 const table = document.getElementById("measurementTable")
 const cards = document.getElementById("measurementCards")
 table.innerHTML = ""
 cards.innerHTML = ""

 measurements.forEach((m,i)=>{
  // TABLE
  table.innerHTML += `
   <tr class="border-t">
    <td class="p-3">${i+1}</td>
    <td class="p-3">${m.name}</td>
    <td class="p-3">${m.remarks}</td>
    <td class="p-3 text-center cursor-pointer text-emerald-600" onclick="editMeasurement(${i})">‚úèÔ∏è</td>
    <td class="p-3 text-center cursor-pointer text-red-500" onclick="deleteMeasurement(${i})">üóëÔ∏è</td>
   </tr>
  `

  // MOBILE CARD
  cards.innerHTML += `
   <div class="bg-white rounded-xl shadow p-4">
    <h3 class="font-bold text-lg">${m.name}</h3>
    <p class="text-slate-600 text-sm">${m.remarks}</p>
    <div class="flex justify-end gap-4 mt-3">
     <button onclick="editMeasurement(${i})" class="text-teal-600">Edit</button>
     <button onclick="deleteMeasurement(${i})" class="text-red-500">Delete</button>
    </div>
   </div>
  `
 })
}

function openModal(){
 modal.classList.add("active")
}

function closeModal(){
 modal.classList.remove("active")
 editIndex = null
 nameInput.value = ""
 remarksInput.value = ""
}

function saveMeasurement(){
 const name = nameInput.value.trim()
 if(!name) return alert("Measurement name required")

 const data = {
  name,
  remarks: remarksInput.value
 }

 if(editIndex !== null){
  measurements[editIndex] = data
 } else {
  measurements.push(data)
 }

 closeModal()
 renderUI()
}

function editMeasurement(i){
 editIndex = i
 nameInput.value = measurements[i].name
 remarksInput.value = measurements[i].remarks
 openModal()
}

function deleteMeasurement(i){
 if(confirm("Delete this measurement?")){
  measurements.splice(i,1)
  renderUI()
 }
}

renderUI()
lucide.createIcons()
</script>

{%endblock%}