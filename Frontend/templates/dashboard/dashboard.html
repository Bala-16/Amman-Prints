{% extends "nav.html" %}

{% block title %}Dashboard{% endblock %}

{% block extra_head %}
<style>
  body {
    background: linear-gradient(135deg, #f8fafc, #eef2ff);
  }

  .dashboard-wrap {
    max-width: 1400px;
    margin: auto;
    padding: 35px;
  }

  /* ================= HEADER ================= */
  .dash-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 35px;
    padding: 22px;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 22px rgba(0, 0, 0, 0.08);
  }

  .dash-header h1 {
    font-size: 30px;
    font-weight: 900;
    margin: 0;
    color: #111827;
  }

  .dash-header p {
    margin: 6px 0 0;
    font-size: 14px;
    color: #6b7280;
  }

  /* ================= QUICK BUTTONS ================= */
  .quick-actions {
    display: flex;
    gap: 14px;
  }

  .quick-btn {
    padding: 12px 18px;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    font-weight: 700;
    font-size: 14px;
    transition: 0.3s;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .quick-btn.primary {
    background: linear-gradient(135deg, #14b8a6, #06b6d4);
    color: white;
  }

  .quick-btn.secondary {
    background: white;
    border: 1px solid #e5e7eb;
    color: #111827;
  }

  .quick-btn:hover {
    transform: translateY(-4px);
  }

  /* ================= SUMMARY CARDS ================= */
  .dash-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 22px;
    margin-bottom: 35px;
  }

  .card-box {
    padding: 26px;
    border-radius: 20px;
    color: white;
    font-weight: 700;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.14);
    transition: 0.35s;
  }

  .card-box:hover {
    transform: translateY(-8px);
  }

  .card-box h3 {
    font-size: 15px;
    margin: 0;
    opacity: 0.9;
  }

  .card-box p {
    font-size: 38px;
    margin: 14px 0 0;
    font-weight: 900;
  }

  .c1 { background: linear-gradient(135deg, #4f46e5, #6366f1); }
  .c2 { background: linear-gradient(135deg, #14b8a6, #06b6d4); }
  .c3 { background: linear-gradient(135deg, #f97316, #fb7185); }
  .c4 { background: linear-gradient(135deg, #22c55e, #16a34a); }

  /* ================= GRID SECTION ================= */
  .dash-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 22px;
    margin-bottom: 30px;
  }

  .dash-box {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 20px;
    padding: 22px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
  }

  .dash-box h2 {
    font-size: 18px;
    font-weight: 900;
    margin-bottom: 15px;
  }

  /* ================= NOTIFICATION ================= */
  .notify {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .notify-item {
    padding: 14px;
    border-radius: 14px;
    background: #f9fafb;
    border-left: 5px solid #14b8a6;
    font-size: 14px;
  }

  .notify-item strong {
    display: block;
    font-size: 15px;
    margin-bottom: 4px;
  }

  /* ================= TABLE ================= */
  table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 14px;
    overflow: hidden;
  }

  th {
    background: #f1f5f9;
    padding: 14px;
    text-align: left;
    font-size: 14px;
    font-weight: 700;
  }

  td {
    padding: 14px;
    border-bottom: 1px solid #e5e7eb;
    font-size: 14px;
  }

  tr:hover {
    background: #f9fafb;
  }

  /* ================= TABLE GRID RESPONSIVE FIX ================= */
  .table-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 22px;
    margin-top: 30px;
  }

  /* Tablet */
  @media(max-width: 1100px) {
    .table-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* Mobile */
  @media(max-width: 768px) {
    .dash-grid {
      grid-template-columns: 1fr;
    }

    .table-grid {
      grid-template-columns: 1fr;
    }

    table {
      display: block;
      overflow-x: auto;
      white-space: nowrap;
    }

    .quick-actions {
      flex-direction: column;
      width: 100%;
    }

    .quick-btn {
      width: 100%;
      justify-content: center;
    }
  }
</style>
{% endblock %}


{% block content %}
<div class="dashboard-wrap">

  <!-- ================= HEADER ================= -->
  <div class="dash-header">
    <div>
      <h1>Dashboard</h1>
      <p>Production, Delivery & Reports Overview</p>
    </div>

    <div class="quick-actions">
      <a href="/jobcard/job_creation/">
        <button class="quick-btn primary">âž• New Job</button>
      </a>
      <a href="/jobcard/job_list/">
        <button class="quick-btn secondary">ðŸ“‹ Job List</button>
      </a>
    </div>
  </div>


  <!-- ================= SUMMARY CARDS ================= -->
  <div class="dash-cards">
    <div class="card-box c1">
      <h3>Total Job Cards</h3>
      <p>{{ total_jobs }}</p>
    </div>

    <div class="card-box c2">
      <h3>Printing Pending</h3>
      <p>{{ printing_pending }}</p>
    </div>

    <div class="card-box c3">
      <h3>Fusing Pending</h3>
      <p>{{ fusing_pending }}</p>
    </div>

    <div class="card-box c4">
      <h3>Delivery Pending</h3>
      <p>{{ delivery_pending }}</p>
    </div>
  </div>


  <!-- ================= GRID SECTION ================= -->
  <div class="dash-grid">

    <!-- Chart -->
    <div class="dash-box">
      <h2>ðŸ“Š Monthly Production Chart</h2>
      <canvas id="prodChart"></canvas>
    </div>

    <!-- Notifications -->
    <div class="dash-box">
      <h2>ðŸ”” Notifications</h2>

      <div class="notify">
        <div class="notify-item">
          <strong>Printing Pending</strong>
          {{ printing_pending }} jobs waiting for print
        </div>

        <div class="notify-item">
          <strong>Fusing Pending</strong>
          {{ fusing_pending }} jobs waiting for fusing
        </div>

        <div class="notify-item">
          <strong>Delivery Pending</strong>
          {{ delivery_pending }} deliveries not completed
        </div>
      </div>
    </div>

  </div>


  <!-- ================= PRINTING + FUSING + DELIVERY TABLES ================= -->
  <div class="table-grid">

    <!-- Printing -->
    <div class="dash-box">
      <h2>ðŸ–¨ Printing Pending Jobs</h2>
      <table>
        <thead>
          <tr>
            <th>Sno</th>
            <th>Job No</th>
            <th>Customer</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for job in printing_jobs %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ job.job_no }}</td>
            <td>{{ job.customer }}</td>
            <td>{{ job.status }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="4">âœ… No Printing Pending</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Fusing -->
    <div class="dash-box">
      <h2>ðŸ”¥ Fusing Pending Jobs</h2>
      <table>
        <thead>
          <tr>
            <th>Sno</th>
            <th>Job No</th>
            <th>Customer</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for job in fusing_jobs %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ job.job_no }}</td>
            <td>{{ job.customer }}</td>
            <td>{{ job.status }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="4">âœ… No Fusing Pending</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Delivery -->
    <div class="dash-box">
      <h2>ðŸšš Delivery Pending Jobs</h2>
      <table>
        <thead>
          <tr>
            <th>Sno</th>
            <th>Job No</th>
            <th>Customer</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for job in delivery_jobs %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ job.job_no }}</td>
            <td>{{ job.customer }}</td>
            <td>{{ job.status }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="4">âœ… No Delivery Pending</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>

</div>


<!-- ================= CHART JS ================= -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const ctx = document.getElementById("prodChart");

  new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
      datasets: [{
        label: "Production Jobs",
        data: [12, 19, 8, 15, 20, 10],
      }]
    }
  });
</script>

{% endblock %}
