{%extends "nav.html"%}
{%block title%}Printer Customer{%endblock%}
{%block extra_head%}

  <script src="https://cdn.tailwindcss.com"></script>
<!-- </head> -->

{%endblock%}
{%block content%}
<div class="bg-slate-100 min-h-screen p-4">

<div class="max-w-7xl mx-auto space-y-6">

  <!-- ‚úÖ BEAUTIFUL HEADER -->
  <div class="w-full bg-gradient-to-r from-teal-600 to-cyan-500
              rounded-2xl shadow-lg px-8 py-6
              flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">

    <div class="flex items-center gap-5">
      <div class="bg-white/20 p-4 rounded-xl">
        üñ®Ô∏è
      </div>

      <div>
        <h1 class="text-3xl font-bold text-white">
          Printer Production Entry
        </h1>
        <p class="text-white/80 text-sm">
          Manage daily printer production details
        </p>
      </div>
    </div>

    <button onclick="window.print()"
      class="bg-white/20 hover:bg-white/30 text-white
             px-6 py-3 rounded-xl font-semibold shadow transition">
      Print
    </button>
  </div>

 <!-- ‚úÖ JOB DETAILS (Editable Inputs Like Form) -->
<div class="bg-white rounded-xl shadow-lg p-6">

  <h2 class="text-lg font-bold text-teal-700 mb-4">
    Job Details
  </h2>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">

    <!-- Jobcard No -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Jobcard No *
      </label>
      <input type="text" value="JC-2404-0003"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

    <!-- Customer -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Customer *
      </label>
      <input type="text" value="M.B GARMENTS"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

    <!-- Style -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Style No *
      </label>
      <input type="text" value="JR Recharge 3D"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

    <!-- Job Type -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Job Type *
      </label>
      <select
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
        <option selected>Production</option>
        <option>Sample</option>
        <option>Rework</option>
      </select>
    </div>

    <!-- Fabric Type -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Fabric Type *
      </label>
      <select
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
        <option selected>DOMESTIC</option>
        <option>EXPORT</option>
      </select>
    </div>

    <!-- Style Name -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Style Name *
      </label>
      <input type="text" value="Front - 6 Color"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

    <!-- Combo -->
    <div class="lg:col-span-2">
      <label class="text-sm text-slate-600 font-medium">
        Combo Colors *
      </label>
      <input type="text"
        value="Red, Black, Navy, Yellow"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

    <!-- Printed Qty -->
    <div>
      <label class="text-sm text-slate-600 font-medium">
        Printed Qty
      </label>
      <input type="number" value="5200"
        class="w-full mt-1 border rounded-lg px-3 py-2 
               focus:ring-2 focus:ring-teal-400 outline-none">
    </div>

  </div>
</div>

  <!-- ‚úÖ TABLE SECTION -->
  <div class="bg-white rounded-xl shadow overflow-hidden">

    <div class="p-4 border-b flex justify-between items-center">
      <p class="font-semibold text-slate-600">
        Production Records
      </p>

      <button onclick="openModal()"
        class="bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700">
        + Add Entry
      </button>
    </div>

    <!-- Responsive Scroll -->
    <div class="overflow-x-auto">
      <table class="w-full text-sm text-left">
        <thead class="bg-slate-100">
          <tr>
            <th class="p-3">Date</th>
            <th class="p-3">Shift</th>
            <th class="p-3">Machine</th>
            <th class="p-3">Operator</th>
            <th class="p-3">Size</th>
            <th class="p-3 text-right">T.Qty</th>
            <th class="p-3 text-right">P.Qty</th>
            <th class="p-3 text-right">Balance</th>
            <th class="p-3 text-center">Action</th>
          </tr>
        </thead>

        <tbody id="tableBody"></tbody>
      </table>
    </div>
  </div>

  <!-- ‚úÖ SUBMIT BUTTON -->
  <div class="text-center">
    <button onclick="submitData()"
      class="bg-green-600 hover:bg-green-700 text-white
             px-10 py-3 rounded-xl font-bold shadow-lg">
      SUBMIT
    </button>
  </div>

</div>

<!-- ‚úÖ MODAL -->
<div id="modal"
  class="fixed inset-0 hidden bg-black/50 flex items-center justify-center">

  <div class="bg-white rounded-xl shadow-xl w-full max-w-lg p-6">

    <h2 class="text-xl font-bold text-teal-700 mb-4">
      Add Production Entry
    </h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

      <input id="date" type="date"
        class="border p-2 rounded" />

      <select id="shift" class="border p-2 rounded">
        <option>DAY</option>
        <option>NIGHT</option>
      </select>

      <input id="machine" placeholder="Machine No"
        class="border p-2 rounded" />

      <input id="operator" placeholder="Operator"
        class="border p-2 rounded" />

      <input id="size" placeholder="Size"
        class="border p-2 rounded" />

      <input id="tqty" type="number" placeholder="Total Qty"
        class="border p-2 rounded" />

      <input id="pqty" type="number" placeholder="Produced Qty"
        class="border p-2 rounded" />

    </div>

    <div class="flex justify-between mt-6">
      <button onclick="closeModal()"
        class="px-6 py-2 rounded bg-slate-300">
        Cancel
      </button>

      <button onclick="addRow()"
        class="px-6 py-2 rounded bg-teal-600 text-white">
        Save
      </button>
    </div>

  </div>
</div>
</div>
{%endblock%}
{%block extra_js%}
<script>
let rows = [];
let editIndex = -1;

function renderTable() {
  let body = document.getElementById("tableBody");
  body.innerHTML = "";

  rows.forEach((r, i) => {
    body.innerHTML += `
      <tr class="border-t hover:bg-slate-50">
        <td class="p-3">${r.date}</td>
        <td class="p-3">${r.shift}</td>
        <td class="p-3">${r.machine}</td>
        <td class="p-3">${r.operator}</td>
        <td class="p-3">${r.size}</td>
        <td class="p-3 text-right">${r.tqty}</td>
        <td class="p-3 text-right">${r.pqty}</td>
        <td class="p-3 text-right">${r.tqty - r.pqty}</td>

        <td class="p-3 text-center space-x-2">
          <button onclick="editRow(${i})"
            class="text-blue-600 font-bold">Edit</button>

          <button onclick="deleteRow(${i})"
            class="text-red-600 font-bold">Delete</button>
        </td>
      </tr>
    `;
  });
}

function openModal() {
  document.getElementById("modal").classList.remove("hidden");
}

function closeModal() {
  document.getElementById("modal").classList.add("hidden");
}

function addRow() {
  let entry = {
    date: date.value,
    shift: shift.value,
    machine: machine.value,
    operator: operator.value,
    size: size.value,
    tqty: Number(tqty.value),
    pqty: Number(pqty.value),
  };

  rows.push(entry);
  closeModal();
  renderTable();
}

function deleteRow(i) {
  rows.splice(i, 1);
  renderTable();
}

function editRow(i) {
  let r = rows[i];

  date.value = r.date;
  shift.value = r.shift;
  machine.value = r.machine;
  operator.value = r.operator;
  size.value = r.size;
  tqty.value = r.tqty;
  pqty.value = r.pqty;

  rows.splice(i, 1);
  openModal();
}

function submitData() {
  if (rows.length === 0) {
    alert("No records added!");
    return;
  }

  if (confirm("Are you sure you want to Submit?")) {
    alert("‚úÖ Submitted Successfully!");
  }
}

function editField(id) {
  let current = document.getElementById(id).innerText;
  let value = prompt("Enter new value:", current);

  if (value) {
    document.getElementById(id).innerText = value;
  }
}
</script>

{%endblock%}
