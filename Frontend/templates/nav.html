<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}Print Management System{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      :root {
        --primary: #14b8a6;
        --background: #f9fafb;
        --text-primary: #111827;
      }

      * {
        box-sizing: border-box;
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          sans-serif;
      }

      body {
        margin: 0;
        background: #eef2f7;
      }

      /* ================= HEADER ================= */
      .header {
        background: linear-gradient(135deg, #14b8a6 0%, #06b6d4 100%);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 9999 !important; /* ðŸ”¥ HIGH Z-INDEX */
      }

      .header-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 10px 25px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
      }

      .logo-section {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      .logo-title {
        font-size: 20px;
        font-weight: 800;
        letter-spacing: -0.5px;
        color: white;
        margin: 0;
      }

      .logo-subtitle {
        font-size: 11px;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
        margin: 0;
      }

      /* ================= NAV ================= */
      .nav-menu {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
      }

      .nav-item {
        position: relative; /* ðŸ”¥ Required for dropdown positioning */
        z-index: 10000; /* ðŸ”¥ Ensure parent is above content */
      }

      .nav-button {
        padding: 8px 16px;
        background: transparent;
        border: none;
        color: white;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
        text-decoration: none;
      }

      .nav-button:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      .nav-button.active {
        background: rgba(255, 255, 255, 0.2);
      }

      /* ðŸ”¥ DROPDOWN MENU - FIXED POSITION & Z-INDEX */
      .dropdown-menu {
        position: absolute !important;
        top: 100%;
        left: 0;
        margin-top: 6px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        min-width: 220px;
        padding: 8px;
        z-index: 10000 !important; /* ðŸ”¥ HIGHEST Z-INDEX */
        
        /* Animation */
        opacity: 0;
        transform: translateY(10px);
        visibility: hidden;
        transition: all 0.25s ease;
        pointer-events: none; /* Prevent click when hidden */
      }

      /* Show dropdown on hover */
      .nav-item:hover .dropdown-menu {
        opacity: 1;
        transform: translateY(0px);
        visibility: visible;
        pointer-events: auto; /* Enable click when visible */
      }

      .dropdown-item {
        display: block;
        width: 100%;
        padding: 10px 12px;
        background: transparent;
        border: none;
        color: var(--text-primary);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border-radius: 8px;
        text-align: left;
        text-decoration: none;
      }

      .dropdown-item:hover {
        background: var(--background);
        color: var(--primary);
      }

      /* ================= ACTIONS ================= */
      .header-actions {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .welcome-text {
        color: white;
        font-size: 14px;
        font-weight: 500;
      }

      .logout-button {
        padding: 8px 16px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .logout-button:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      /* ================= MAIN CONTENT - BEHIND NAV ================= */
      main {
        position: relative;
        z-index: 1; /* ðŸ”¥ Content stays behind dropdowns */
      }

      /* ================= MOBILE ================= */
      .hamburger {
        display: none;
        font-size: 22px;
        color: white;
        background: transparent;
        border: none;
        cursor: pointer;
      }

      .mobile-menu {
        display: none;
        background: white;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        padding: 12px;
        position: fixed;
        top: 70px;
        left: 0;
        width: 100%;
        z-index: 10000 !important; /* ðŸ”¥ HIGH Z-INDEX */
      }

      .mobile-menu .nav-button {
        color: #111827;
        width: 100%;
        justify-content: space-between;
      }

      /* Mobile submenu positioning */
      @media (max-width: 1024px) {
        .mobile-menu .dropdown-menu {
          position: fixed !important;
          top: 70px;
          left: 0;
          width: 100%;
          background: #fff;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          padding: 12px;
          z-index: 10001 !important; /* ðŸ”¥ Even higher for mobile */
          display: none;
          opacity: 1;
          transform: none;
          visibility: visible;
          pointer-events: auto;
        }
        
        .mobile-menu .dropdown-menu.show {
          display: block;
        }
      }

      @media (max-width: 1024px) {
        .nav-menu {
          display: none;
        }

        .header-actions {
          display: none;
        }

        .hamburger {
          display: block;
        }
      }
      
      @media (min-width: 1025px) {
        .mobile-menu {
          display: none !important;
        }
      }
    </style>
    {% block extra_head %}{% endblock %}
  </head>
  <body>
    <header class="header">
      <div class="header-container">
        <div class="logo-section">
          <h1 class="logo-title">SRI AMMAN DIGITAL PRINTS</h1>
          <p class="logo-subtitle">Print Management System</p>
        </div>

        <button class="hamburger" onclick="toggleMobileMenu()">â˜°</button>

        <nav class="nav-menu">
          <div class="nav-item">
            <a href="{% url 'dashboard' %}" class="nav-button active">Dashboard</a>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="toggleMasterMenu(event)">
              Master Creation â–¾
            </button>
            <div id="masterMenu" class="dropdown-menu">
              <a href="/mastercreation/user_type_creation/" class="dropdown-item">User Type Creation</a>
              <a href="/mastercreation/party_creation/" class="dropdown-item">Party Creation</a>
              <a href="/mastercreation/company_creation/" class="dropdown-item">Company Creation</a>
              <a href="/mastercreation/operator/" class="dropdown-item">Operator Creation</a>
              <a href="/mastercreation/measurement/" class="dropdown-item">Unit Measurement</a>
              <a href="/mastercreation/userpermission/" class="dropdown-item">User Rights Creation</a>
              <a href="/mastercreation/userscreen/" class="dropdown-item">User Screen</a>
              <a href="/mastercreation/machinecreation/" class="dropdown-item">Machine Creation</a>
              <a href="/mastercreation/shift/" class="dropdown-item">Shift Creation</a>
              <a href="/mastercreation/paymentterms/" class="dropdown-item">Payment Terms</a>
              <a href="/mastercreation/consumablecreation/" class="dropdown-item">Consumable Creation</a>
              <a href="/mastercreation/fabrictype/" class="dropdown-item">Fabric Type</a>
              <a href="/mastercreation/rollsize/" class="dropdown-item">Roll Size</a>
              <a href="/mastercreation/gapcreation/" class="dropdown-item">Gap Creation</a>
              <a href="/mastercreation/jobtypecreation/" class="dropdown-item">Job typ Creation</a>
              <a href="/mastercreation/customerstatus/" class="dropdown-item">Customer status</a>
              <a href="/mastercreation/user_name/" class="dropdown-item">User Name Creation</a>
            </div>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="toggleJobCardMenu(event)">
              Job Card â–¾
            </button>
            <div id="jobCardMenu" class="dropdown-menu">
              <a href="{% url 'jobcard_form' %}" class="dropdown-item">New Job Card</a>
              <a href="{% url 'quotation_list' %}" class="dropdown-item">Quotation New</a>
              <a href="/jobcard/designer_report/" class="dropdown-item">Designer Report</a>
              <a href="/customer_report/" class="dropdown-item">Customer Report</a>
              <a href="/process_report/" class="dropdown-item">Process Report</a>
              <a href="{% url 'quotation_customer_report' %}" class="dropdown-item">Quotation Customer Report</a>
            </div>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="toggleConMenu(event)">
              Consumable â–¾
            </button>
            <div id="conMenu" class="dropdown-menu">
              <a href="/consumable/ink_entry/" class="dropdown-item">Ink Entry</a>
              <a href="/consumable/return_form/" class="dropdown-item">Return Form</a>
              <a href="/consumable/stock_report/" class="dropdown-item">Stock Report</a>
            </div>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="toggleDeliveryMenu(event)">
              Delivery â–¾
            </button>
            <div id="mdelivery" class="dropdown-menu">
              <a href="/delivery/inward/" class="dropdown-item">Inward Entry</a>
              <a href="/delivery/fabric/" class="dropdown-item">Fabric Delivery Challan</a>
              <a href="/delivery/sticker/" class="dropdown-item">Sticker Delivery Challan</a>
              <a href="/delivery/return/" class="dropdown-item">Return Form</a>
              <a href="/delivery/deli/" class="dropdown-item">Delivery Report</a>
            </div>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="togglePrintingMenu(event)">
              Printing â–¾
            </button>
            <div id="printingMenu" class="dropdown-menu">
              <a href="/printing/printer_production" class="dropdown-item">Production Entry</a>
              <a href="/printing/printer_jobwise/" class="dropdown-item">Job No Wise Report</a>
              <a href="/printing/printer_operator/" class="dropdown-item">Operator Wise Report</a>
              <a href="/printing/printer_machine/" class="dropdown-item">Machine Wise Report</a>
              <a href="/printing/printer_customer/" class="dropdown-item">Customer Wise Report</a>
              <a href="/printing/printer_data/" class="dropdown-item">Data Wise Report</a>
            </div>
          </div>

          <div class="nav-item">
            <button class="nav-button" onclick="toggleFusingMenu(event)">
              Fusing â–¾
            </button>
            <div id="fusingMenu" class="dropdown-menu">
              <a href="/fusing/fusing-production-entry/" class="dropdown-item">Fusing Production Entry</a>
              <a href="/fusing/job-no-wise-report/" class="dropdown-item">Job No Wise Report</a>
              <a href="/fusing/fusing-operator-wise-report/" class="dropdown-item">Fusing Operator Wise Report</a>
              <a href="/fusing/fusing-machine-wise-report/" class="dropdown-item">Fusing Machine Wise Report</a>
              <a href="/fusing/fusing-customer-wise-report/" class="dropdown-item">Fusing Customer Wise Report</a>
              <a href="/fusing/date-wise-report/" class="dropdown-item">Date Wise Report</a>
            </div>
          </div>

          <div class="nav-item">
            <a href="/accounts/" class="nav-button">Accounts</a>
          </div>
        </nav>
      </div>
    </header>
    
    <main>{% block content %}{% endblock %}</main>

    <!-- MOBILE MENU -->
    <div id="mobileMenu" class="mobile-menu">
      <a href="/dashboard/" class="nav-button">Dashboard</a>

      <button class="nav-button" onclick="toggleMobileSub('mMaster')">
        Master Creation â–¾
      </button>
      <div id="mMaster" class="dropdown-menu">
        <a href="/mastercreation/user_name/" class="dropdown-item">User Name Creation</a>
        <a href="/mastercreation/user_type_creation/" class="dropdown-item">User Type Creation</a>
        <a href="/mastercreation/party_creation/" class="dropdown-item">Party Creation</a>
        <a href="/mastercreation/company_creation/" class="dropdown-item">Company Creation</a>
        <a href="/mastercreation/operator/" class="dropdown-item">Operator Creation</a>
        <a href="/mastercreation/measurement/" class="dropdown-item">Unit Measurement</a>
        <a href="/mastercreation/userpermission/" class="dropdown-item">User Rights Creation</a>
        <a href="/mastercreation/userscreen/" class="dropdown-item">User Screen</a>
        <a href="/mastercreation/machinecreation/" class="dropdown-item">Machine Creation</a>
        <a href="/mastercreation/shift/" class="dropdown-item">Shift Creation</a>
        <a href="/mastercreation/paymentterms/" class="dropdown-item">Payment Terms</a>
        <a href="/mastercreation/consumablecreation/" class="dropdown-item">Consumable Creation</a>
        <a href="/mastercreation/fabrictype/" class="dropdown-item">Fabric Type</a>
        <a href="/mastercreation/rollsize/" class="dropdown-item">Roll Size Creation</a>
        <a href="/mastercreation/gapcreation/" class="dropdown-item">Gap Creation</a>
        <a href="/mastercreation/jobtypecreation/" class="dropdown-item">Job typ Creation</a>
        <a href="/mastercreation/customerstatus/" class="dropdown-item">Customer status</a>
      </div>

      <button class="nav-button" onclick="toggleMobileSub('mJob')">
        Job Card â–¾
      </button>
      <div id="mJob" class="dropdown-menu">
        <a href="/jobcard/job_creation/" class="dropdown-item">New Job Card</a>
        <a href="/jobcard/job_list/" class="dropdown-item">Job Card List</a>
        <a href="/jobcard/quotation/" class="dropdown-item">Quotation List</a>
        <a href="/jobcard/designer_report/" class="dropdown-item">Designer Report</a>
        <a href="/customer_report/" class="dropdown-item">Customer Report</a>
        <a href="/quotation_customer/" class="dropdown-item">Quotation Customer Report</a>
        <a href="/jobcard/process_report/" class="dropdown-item">Process Report</a>
        <a href="/jobcard/process_quotationform/" class="dropdown-item">Quotation Form</a>
      </div>

      <button class="nav-button" onclick="toggleMobileSub('mCon')">
        Consumable â–¾
      </button>
      <div id="mCon" class="dropdown-menu">
        <a href="/consumable/ink_entry/" class="dropdown-item">Ink Entry</a>
        <a href="/consumable/return_form/" class="dropdown-item">Return Form</a>
        <a href="/consumable/stock_report/" class="dropdown-item">Stock Report</a>
      </div>

      <button class="nav-button" onclick="toggleMobileSub('mDel')">
        Delivery â–¾
      </button>
      <div id="mDel" class="dropdown-menu">
        <a href="/delivery/inward/" class="dropdown-item">Inward Entry</a>
        <a href="/delivery/fabric/" class="dropdown-item">Fabric Delivery Challan</a>
        <a href="/delivery/sticker/" class="dropdown-item">Sticker Delivery Challan</a>
        <a href="/delivery/return/" class="dropdown-item">Return Form</a>
        <a href="/delivery/deli/" class="dropdown-item">Delivery Report</a>
      </div>

      <button class="nav-button" onclick="toggleMobileSub('mprinting')">
        Printing â–¾
      </button>
      <div id="mprinting" class="dropdown-menu">
        <a href="/printing/printer_production" class="dropdown-item">Production Entry</a>
        <a href="/printing/printer_jobwise/" class="dropdown-item">Job No Wise Report</a>
        <a href="/printing/printer_operator/" class="dropdown-item">Operator Wise Report</a>
        <a href="/printing/printer_machine/" class="dropdown-item">Machine Wise Report</a>
        <a href="/printing/printer_customer/" class="dropdown-item">Customer Wise Report</a>
        <a href="/printing/printer_data/" class="dropdown-item">Data Wise Report</a>
      </div>

      <button class="nav-button" onclick="toggleMobileSub('mFusing')">
        Fusing â–¾
      </button>
      <div id="mFusing" class="dropdown-menu">
        <a href="/fusing/fusing-production-entry/" class="dropdown-item">Fusing Production Entry</a>
        <a href="/fusing/job-no-wise-report/" class="dropdown-item">Job No Wise Report</a>
        <a href="/fusing/fusing-operator-wise-report/" class="dropdown-item">Fusing Operator Wise Report</a>
        <a href="/fusing/fusing-machine-wise-report/" class="dropdown-item">Fusing Machine Wise Report</a>
        <a href="/fusing/fusing-customer-wise-report/" class="dropdown-item">Fusing Customer Wise Report</a>
        <a href="/fusing/date-wise-report/" class="dropdown-item">Date Wise Report</a>
      </div>

      <a href="/accounts/" class="nav-button">Accounts</a>
    </div>

    <script>
      // Get all dropdown menus
      const dropdowns = {
        jobCard: document.getElementById("jobCardMenu"),
        master: document.getElementById("masterMenu"),
        fusing: document.getElementById("fusingMenu"),
        printing: document.getElementById("printingMenu"),
        delivery: document.getElementById("mdelivery"),
        consumable: document.getElementById("conMenu"),
        mobile: document.getElementById("mobileMenu")
      };

      // Close all desktop dropdowns
      function closeAllDesktopDropdowns() {
        Object.values(dropdowns).forEach(menu => {
          if (menu && !menu.classList.contains('mobile-menu')) {
            menu.style.display = "none";
          }
        });
      }

      // Toggle functions with event parameter
      function toggleJobCardMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.jobCard;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function toggleMasterMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.master;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function toggleFusingMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.fusing;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function togglePrintingMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.printing;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function toggleDeliveryMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.delivery;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function toggleConMenu(e) {
        e?.stopPropagation();
        const menu = dropdowns.consumable;
        const isShowing = menu.style.display === "block";
        closeAllDesktopDropdowns();
        menu.style.display = isShowing ? "none" : "block";
      }

      function toggleMobileMenu() {
        const menu = dropdowns.mobile;
        menu.style.display = menu.style.display === "block" ? "none" : "block";
        closeAllDesktopDropdowns();
      }

      function toggleMobileSub(id) {
        // Close all other mobile submenus
        document.querySelectorAll(".mobile-menu .dropdown-menu").forEach((menu) => {
          if (menu.id !== id) {
            menu.classList.remove("show");
            menu.style.display = "none";
          }
        });
        // Toggle clicked submenu
        const el = document.getElementById(id);
        const isShowing = el.classList.contains("show");
        el.classList.toggle("show");
        el.style.display = isShowing ? "none" : "block";
      }

      // Close dropdowns when clicking outside
      document.addEventListener("click", (e) => {
        if (!e.target.closest(".nav-item")) {
          closeAllDesktopDropdowns();
        }
      });

      // Close mobile menu on resize to desktop
      window.addEventListener("resize", () => {
        if (window.innerWidth > 1024) {
          if (dropdowns.mobile) dropdowns.mobile.style.display = "none";
          document.querySelectorAll(".mobile-menu .dropdown-menu").forEach((el) => {
            el.classList.remove("show");
            el.style.display = "none";
          });
        }
      });

      // Prevent dropdown close when clicking inside it
      document.querySelectorAll('.dropdown-menu').forEach(menu => {
        menu.addEventListener('click', (e) => {
          e.stopPropagation();
        });
      });
    </script>
    {% block extra_js %}{% endblock %}
  </body>
</html>